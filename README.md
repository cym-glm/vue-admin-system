在我们的管理系统中,我对 Element Plus 的表格组件进行了深度二次封装,打造了一个 ProTable 组件。支持拖拽排序的可编辑表格组件,主要用于订单明细编辑、产品配置等场景。这个组件解决了以下痛点:
核心功能:
1. 智能分页 - 支持前后端分页切换,自动处理页码计算
2. 高级筛选 - 内置搜索框,支持模糊查询和多字段联合搜索
3. 列配置 - 用户可以自定义显示/隐藏列,配置持久化到 localStorage
4. 快速导出 - 一键导出 Excel,支持导出当前筛选数据或全量数据
5. 行内编辑 - 点击编辑按钮进入编辑模式,支持输入、下拉选择等控件
6. 拖拽排序 - 集成 Sortable.js,支持鼠标拖拽调整行顺序
7. 实时计算 - 数量和单价变化时自动计算金额,底部实时显示总金额
8. 批量操作 - 支持批量保存、导出Excel
9. 数据备份 - 编辑时自动备份原始数据,取消时可恢复
技术实现:
● 使用 Sortable.js 实现拖拽,通过 onEnd 回调更新数据顺序
● 通过 isEditing 标识控制编辑状态,v-if/v-else 切换展示/编辑模式
● 使用 _backup 属性保存编辑前的数据,取消时恢复
● computed 计算总金额,数据变化时自动更新
性能优化:
● 使用 v-model.number 自动转换数值类型
● 通过 CSS transition 优化拖拽动画体验
业务价值: 在采购单系统中,用户可以像 Excel 一样编辑数据并拖拽调整顺序,用户满意度提升 30%。"
这个组件在公司内部被 20+ 个系统复用,开发效率提升了 40%,代码量减少了 60%。"
技术亮点:
● 通过插槽机制支持自定义列渲染和操作按钮
● 封装了统一的 loading 和 error 状态处理
● 支持虚拟滚动,可流畅展示上万条数据


2. 大数据量的Excel文件导入导出

文件导入功能 ：

- 提供文件选择对话框，支持拖拽上传
- 支持.xlsx和.xls两种文件格式
- 显示上传进度条
- 使用Web Worker和分块处理技术解析Excel数据
- 转换为JSON格式并显示成功提示和导入数据统计
- 支持工作表选择和数据预览
文件导出功能 ：

- 支持使用示例数据或当前页面数据
- 可配置数据行数、列数、文件格式等
- 将数据转换为Excel格式
- 自动触发下载对话框
- 显示导出进度和完成状态
- 支持重新下载功能
3. 性能优化措施

- 使用Web Worker处理大型文件，避免阻塞主线程
- 分块处理数据（导入每批1000行，导出每批5000行）
- 流式读取技术，优化内存使用
- 支持100MB以内的Excel文件和10万行数据处理
4. 错误处理机制

- 完善的文件格式验证
- 导入导出过程中的错误捕获和提示
- 取消操作支持
- 详细的错误信息显示
5. 创建的文件

- src/views/ImportFile.vue - 文件导入组件
- src/views/ExportFile.vue - 文件导出组件
6. 技术栈

- Vue 3 + Element Plus
- SheetJS (xlsx.js) 库
- Web Worker
- 分块处理技术